import type { Context } from '../tools/context';
import { Observable } from '../tools/observable';
import type { PageExitEvent } from '../browser/pageExitObservable';
import type { HttpRequest } from './httpRequest';
export interface BatchFlushEvent {
    bufferBytesCount: number;
    bufferMessagesCount: number;
}
export declare type FlushReason = 'batch_duration_limit' | 'batch_bytes_limit' | 'before_unload' | 'page_hide' | 'visibility_hidden' | 'page_frozen';
export declare class Batch {
    private request;
    private batchMessagesLimit;
    private batchBytesLimit;
    private messageBytesLimit;
    private flushTimeout;
    private pageExitObservable;
    flushObservable: Observable<BatchFlushEvent>;
    private pushOnlyBuffer;
    private upsertBuffer;
    private bufferBytesCount;
    private bufferMessagesCount;
    constructor(request: HttpRequest, batchMessagesLimit: number, batchBytesLimit: number, messageBytesLimit: number, flushTimeout: number, pageExitObservable: Observable<PageExitEvent>);
    add(message: Context): void;
    upsert(message: Context, key: string): void;
    flush(flushReason: FlushReason, sendFn?: (payload: import("./httpRequest").Payload) => void): void;
    private addOrUpdate;
    private process;
    private push;
    private remove;
    private hasMessageFor;
    private willReachedBytesLimitWith;
    private isFull;
    private flushPeriodically;
}
