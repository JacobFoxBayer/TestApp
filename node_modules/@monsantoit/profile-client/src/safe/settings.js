const namespace = require('./namespace')
const browser = require('./browser')
const _ = require('../lodash')

// profile-client settings, derived from browser globals
const settings = {
    debuggerEnabled() {
        return namespace.get('debugProfileClient', false)
    },

    refreshEnabled() {
        return namespace.get('refreshEnabled', true)
    },

    authEnabled() {
        const notLocalDevelopment = browser.localDevelopment() === false
        const localOcelot = browser.localOcelot() === true

        return notLocalDevelopment || localOcelot
    },

    retryInterval() {
        return 1000 * 5
    },

    tokenFromCookie(name) {
        const cookiePairs = _.get(browser.document(), 'cookie', '')
            .split(';')
            .map((cookie) => cookie.trim().split('='))

        const cookieMap = _.fromPairs(cookiePairs)

        if (_.has(cookieMap, name)) {
            return cookieMap[name]
        }
        return null
    }
}

module.exports = settings
