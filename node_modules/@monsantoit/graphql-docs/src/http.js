const {agent} = require('@monsantoit/profile-client');

const partial = (url, headers = []) => function(graphQLParams) {
    const headersObj = {}
    headers.forEach(({key, value}) => headersObj[key] = value)
    return agent.post(url)
        .set('Content-Type', 'application/json')
        .set(headersObj)
        .send(JSON.stringify(graphQLParams))
        .then(({body}) => body)
        .catch((e) => {
            if (e.response && e.response.body) {
                throw e.response.body
            } else {
                throw e
            }
        })
} ;

module.exports = partial;
