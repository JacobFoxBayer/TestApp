/* eslint-disable prefer-spread */
const superagent = require('superagent')

const createSecureLink = (host, bearerToken) => {
    let navigationUri
    if (host.includes('-np')) {
        navigationUri = 'https://navigation-np.phoenix-tools-np.io'
    } else if (host.includes('localhost')) {
        navigationUri = 'http://localhost:3300'
    } else {
        navigationUri = 'https://navigation.phoenix-tools.io'
    }

    const url = `${navigationUri}/v1/graphql`
    return superagent
        .post(url)
        .set(
            'Authorization',
            bearerToken.startsWith('Bearer ') ? bearerToken : `Bearer ${bearerToken}`
        )
        .set('Content-Type', 'application/json')
}

const getClient = (host, bearerToken) => createSecureLink(host, bearerToken)

module.exports = getClient
