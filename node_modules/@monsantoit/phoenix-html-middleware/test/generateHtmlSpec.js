const generateHtml = require('../src/generateHtml')

describe('generateHtml', () => {
    it('creates html string', () => {
        generateHtml(
            '/myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
                navbarStylesUrl: `https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css`,
            },
            {materialVersion: '0.39.1'}
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/mat0.39.1.css"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/style.css">
</head>
        <body class="navbar-above">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
        </body>
</html>
            `.trim()
        )
    })

    it('creates html string with default navbar styles and favicon when neither are provided', () => {
        generateHtml(
            '/myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
            },
            {materialVersion: '0.39.1'}
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/mat0.39.1.css"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/style.css">
</head>
        <body class="navbar-above">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
        </body>
</html>
            `.trim()
        )
    })

    it('missing forward slash in baseUrl', () => {
        generateHtml(
            'myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
                navbarStylesUrl: 'https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css',
            },
            {materialVersion: '0.39.1'}
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/mat0.39.1.css"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/style.css">
</head>
        <body class="navbar-above">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
        </body>
</html>
`.trim()
        )
    })

    it('using options', () => {
        const headHtml = `<script>window.stuff = 'stuff'</script>
<script>window.moreStuff = 'morestuff'</script>`
        const bodyHtml = `<script type="text/javascript" src="www.scripts.com/helper.js"></script>`
        const i18n = {locale: 'en'}
        generateHtml(
            '/myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
                navbarStylesUrl: 'https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css',
            },
            {
                libType: 'bootstrap',
                headHtml,
                bodyHtml,
                i18n,
                appStyleSuiteSpecific: true,
                classes: 'navbar-above navbar-pinned',
                lightningExpress: true,
            }
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/bs3.css"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/mysuite.css">
<script>
    window.MonI18N = ${JSON.stringify(i18n)}
</script>
${headHtml}
</head>
        <body class="navbar-above navbar-pinned">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings.js"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
${bodyHtml}
        </body>
</html>
`.trim()
        )
    })

    it('creates html string for element', () => {
        generateHtml(
            '/myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
                navbarStylesUrl: `https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css`,
            },
            {libType: 'element'}
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,500,700|Roboto+Mono:400,500|Material+Icons"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/style.css">
</head>
        <body class="navbar-above">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
        </body>
</html>
            `.trim()
        )
    })

    it('creates html string for element with all fonts', () => {
        generateHtml(
            '/myBaseUrl',
            'mytitle',
            {
                id: 'mysuite',
                title: 'mysuite',
                navbarStylesUrl: `https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css`,
            },
            {libType: 'element', allFonts: true}
        ).should.equal(
            `
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<title>mytitle</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,500,700|Roboto+Mono:400,500|Material+Icons|Material+Icons+Outlined|Material+Icons+Round|Material+Icons+Sharp|Material+Icons+Two+Tone"/>
<link rel="stylesheet" href="https://phoenix-tools.io/assets/cached/mysuite/styles/navbar.css"/>
<link rel="stylesheet" href="/myBaseUrl/styles/style.css">
</head>
        <body class="navbar-above">
            <div class="nav"></div>
            <div class="contents"></div>
            <script type="text/javascript" src="/myBaseUrl/service-bindings"></script>
            <script type="text/javascript">window.phoenix.suiteId = "mysuite"</script>
            <script type="text/javascript" src="/myBaseUrl/scripts/bundle.js"></script>
        </body>
</html>
            `.trim()
        )
    })
})
