# Local Development

The navbar's changes can be seen by using the demo project, under `./demo`. It uses webpack to compile the navigation bar and provide a series of demos for each suite.

## Ocelot routes

Create a symlink from `ocelot-config.json` to your ocelot routes directory.

```
ln -s "$PWD/demo/ocelot-config.json" ~/.ocelot/routes/navbar.json
```

## Schema Update

```
get-graphql-schema http://localhost:3893/v1/graphql --json > .graphql/support-workflow-api.schema.json
get-graphql-schema https://support-workflow.phoenix-tools-np.io/v1/graphql --json > .graphql/support-workflow-api.schema.json
```

## Environment Variables

This project parameterizes the auth token in a project-level `.npmrc`. Set the value of your github auth token to `VELOCITY_NPM_PUBLISH_TOKEN`
To run against a local Navigation API `NAVIGATION_API_URL` should be set.

## Paths

There's a number of demos for the navbar. Some suite related, some functionality related.
Each demo can be found under `/demo/scripts/configurations`

The following paths are available to quickly test against. Some of these could probably be consolidated.

### Suite Demos

`/navbar/suite/local` - the default navbar theme
`/navbar/suite/velocity` - the velocity navbar theme
`/navbar/suite/devtools` - the devtools navbar theme
`/navbar/suite/peadmin` - the peadmin navbar theme

### Functional Demos

`/navbar/pinned` - testing against a pinned-by-default navbar
`/navbar/search` - testing search functionality and query params (check dev console for event output)
`/navbar/custom` - testing custom/static mega-menu functionality

Each configuration has a number of options, though not all of them are used on every demo. Below is an example demo configuration:

```javascript
{
    // id: route param to look for.
    id: 'pinned',
    // name: configuration name
    name: 'Pinned',
    // link at the bottom of the page to this configuration
    url: '/navbar/pinned',
    // text: raw text of the file to display in the demo
    text: require('raw-loader!./configurations/pinned'),
    // executable: component to render after bootstrapping
    executable: require('./configurations/pinned')
}
```

### Adding new paths

If testing with a new suite (assuming it's hosted by our S3 proxy, via) you can add a new config that follows the route conventions of the local, velocity, devtools suite configs. `navbar/suite/SUITE_NAME`. If you don't provide a suite id, it defaults to devtools for the suite.

Otherwise, the default navbar theme will be used, with devtools material styles provided to the UI.

## Navbar version

You can set the version for the current navbar as part of the install config. Just pass in a value to the 'version' property that matches the release you want to test against.

Each push to the navbar repo creates a release candidate. If you want to test against the currently deployed candidate, set the version to 'candidate'.

If you want to test against the latest non-candidate release, set the version to 'latest'.

## Local navbar.css

Note there is a suite in the demo called 'local', that loads the navbar.css from the local version rather than from nonprod.

## Updating the bootstrap process

You can make updates to the installer, but avoid this if at all possible. The goal of the bootstrap process should be to set up token fetching, fetch the currently configured navbar version's script, then exit.

Most teams aren't going to update this dependency, so we can't count on this to maintain a
consistent look and feel. If you have to make an update - announce it from the hilltops.

## Releasing new versions

see [RELEASE_PROCESS.md](RELEASE_PROCESS.md)
